plugins {
    id "com.android.application"
    id "kotlin-android"
    id "dev.flutter.flutter-gradle-plugin"
    id "com.google.gms.google-services"
}

def localProperties = new Properties()
def localPropertiesFile = rootProject.file('local.properties')

if (localPropertiesFile.exists()) {
    localPropertiesFile.withReader('UTF-8') { reader -> localProperties.load(reader)
    }
}


def flutterVersionCode = localProperties.getProperty('flutter.versionCode')
if (flutterVersionCode == null) {
    flutterVersionCode = '1'
}

def flutterVersionName = localProperties.getProperty('flutter.versionName')
if (flutterVersionName == null) {
    flutterVersionName = '0.1.0'
}

def minSdkVersionVal = localProperties.getProperty('flutter.minSdkVersion')
if (minSdkVersionVal == null) {
    minSdkVersionVal = '21'
}

def compileSdkVersionVal = localProperties.getProperty('flutter.compileSdkVersion')
if (compileSdkVersionVal == null) {
    compileSdkVersionVal = '34'
}

def targetSdkVersionVal = localProperties.getProperty('flutter.targetSdkVersion')
if (targetSdkVersionVal == null) {
    targetSdkVersionVal = '34'
}



android {
    namespace "ir.vosatezehn.com"
    compileSdkVersion compileSdkVersionVal.toInteger()
    ndkVersion flutter.ndkVersion
    android.buildFeatures.buildConfig true

    ndkVersion "25.1.8937393"    

    lintOptions {
        disable 'InvalidPackage'
        //checkReleaseBuilds false
    }

    java {
        sourceCompatibility = JavaVersion.VERSION_17
        targetCompatibility = JavaVersion.VERSION_17

        toolchain {
            languageVersion.set(JavaLanguageVersion.of(17))
        }
    }

    compileOptions {
        sourceCompatibility JavaVersion.VERSION_17
        targetCompatibility JavaVersion.VERSION_17
        //coreLibraryDesugaringEnabled true
    }

    kotlinOptions {
        jvmTarget = '17'
    }

    kotlin {
        jvmToolchain(17)
    }
    
    sourceSets {
        main.java.srcDirs += 'src/main/java'
    }

    signingConfigs {
        debug {
            storeFile file('E:\\Programming\\Projects\\FlutterProjects\\VosateZehn\\VosateZehn\\android\\vz.keystore')
            keyAlias 'b4a'
            keyPassword 'a6987@7896b'
            storePassword 'a6987@7896b'
        }

        release {
            storeFile file('E:\\Programming\\Projects\\FlutterProjects\\VosateZehn\\VosateZehn\\android\\vz.keystore')
            keyAlias 'b4a'
            keyPassword 'a6987@7896b'
            storePassword 'a6987@7896b'
        }
    }

    defaultConfig {
        applicationId "ir.vosatezehn.com"
        minSdkVersion minSdkVersionVal.toInteger()      //base:16
        targetSdkVersion targetSdkVersionVal.toInteger()
        versionCode flutterVersionCode.toInteger()
        versionName flutterVersionName

        multiDexEnabled false

        def documentsAuthorityValue = applicationId + ".documentsProvider"
        manifestPlaceholders.documentsAuthority = documentsAuthorityValue
        manifestPlaceholders.fileAuthority = applicationId + ".fileProvider"
        manifestPlaceholders.shareAuthority = applicationId + ".shareContentProvider"
        buildConfigField "String", "fileAuthority", "\"${documentsAuthorityValue}\""
    }

    buildTypes {
        debug {
            minifyEnabled true
            shrinkResources true
            zipAlignEnabled true
            ext.enableCrashlytics = false
            ext.alwaysUpdateBuildId = false
            signingConfig signingConfigs.debug
            proguardFiles getDefaultProguardFile('proguard-android-optimize.txt'), 'proguard-rules.pro'
        }

        release {
            minifyEnabled true
            shrinkResources true
            zipAlignEnabled true
            signingConfig signingConfigs.release
            proguardFiles getDefaultProguardFile('proguard-android-optimize.txt'), 'proguard-rules.pro'
        }
    }
}

flutter {
    source '../..'
}


dependencies {
    implementation platform('com.google.firebase:firebase-bom:32.8.1')
    implementation("com.google.firebase:firebase-auth")
    implementation("com.google.android.gms:play-services-auth:21.0.0")
    //implementation 'com.google.firebase:firebase-analytics'
    //implementation 'androidx.annotation:annotation:1.4.0'
    //implementation 'androidx.multidex:multidex:2.0.1'
    //coreLibraryDesugaring 'com.android.tools:desugar_jdk_libs:1.2.2'
    //implementation 'androidx.window:window:1.0.0'
    //implementation 'androidx.window:window-java:1.0.0'
    //implementation fileTree(dir: 'E:\\Programming\\.gradle\\caches\\modules-2\\files-2.1\\io.flutter\\flutter_embedding_debug\\1.0.0-d44b5a94c976fbb65815374f61ab5392a220b084\\5ad0fb193f143c1352aef2c48ca10a99b3eadd1e', include: ['*.aar', '*.jar'], exclude: [])
}